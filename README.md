# Spotify Podcast Extractor con IA

Extrae informaci√≥n detallada de podcasts de tus playlists de Spotify, los categoriza autom√°ticamente usando Gemini AI, y exporta los datos a Excel con persistencia en base de datos SQLite.

## üöÄ Caracter√≠sticas Principales

- ‚úÖ **Extracci√≥n completa**: T√≠tulo, descripci√≥n, duraci√≥n, fechas, URLs
- ü§ñ **Categorizaci√≥n autom√°tica**: Usa Gemini AI para clasificar episodios inteligentemente
- üí¨ **Preguntas y Respuestas**: Pregunta en lenguaje natural sobre el contenido de tus podcasts
- üíæ **Base de datos persistente**: SQLite para evitar procesar episodios duplicados
- üìä **Exportaci√≥n a Excel**: Formato profesional con columnas ajustadas
- üîÑ **Sincronizaci√≥n inteligente**: Solo procesa episodios nuevos
- üéØ **M√∫ltiples modos**: Extracci√≥n, categorizaci√≥n, o solo exportar
- ‚öôÔ∏è **Control de cuota**: Gesti√≥n autom√°tica de l√≠mites de API
- üîí **Seguridad**: Variables de entorno para credenciales

## üìã Requisitos

- **Python 3.7+**
- **Cuenta de Spotify Developer**
- **Gemini API Key** (opcional, para categorizaci√≥n autom√°tica)

## üõ†Ô∏è Instalaci√≥n

### 1. Clona el repositorio
```bash
git clone https://github.com/tu-usuario/spotify-podcast-extractor.git
cd spotify-podcast-extractor
```

### 2. Instala las dependencias
```bash
pip install -r requirements.txt
```

### 3. Configura las variables de entorno
```bash
cp .env.example .env
```

Edita el archivo `.env` con tus credenciales reales:

```bash
# === SPOTIFY API ===
SPOTIFY_CLIENT_ID=tu_client_id_real
SPOTIFY_CLIENT_SECRET=tu_client_secret_real  
SPOTIFY_REDIRECT_URI=https://example.com/callback
SPOTIFY_PLAYLIST_ID=tu_playlist_id_real

# === GEMINI AI (OPCIONAL) ===
GEMINI_API_KEY=tu_gemini_api_key_real
GEMINI_MODEL_NAME=gemini-2.5-flash
GEMINI_RPM_LIMIT=10
MAX_CATEGORIES=8
```

## ‚öôÔ∏è Configuraci√≥n Inicial

### üéµ Configurar Spotify Developer App

1. Ve a [Spotify Developer Dashboard](https://developer.spotify.com/dashboard)
2. Crea una nueva aplicaci√≥n
3. En **"Redirect URIs"** a√±ade: `https://example.com/callback`
4. Copia el `Client ID` y `Client Secret`

### üÜî Obtener ID de Playlist

1. Abre tu playlist en Spotify
2. Copia la URL: `https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M`
3. El ID es: `37i9dQZF1DXcBWIGoYBM5M`

### ü§ñ Configurar Gemini AI (Opcional)

1. Ve a [Google AI Studio](https://aistudio.google.com/app/apikey)
2. Crea una API Key gratuita
3. A√±√°dela como `GEMINI_API_KEY` en tu `.env`

> **üí° Sin Gemini**: El script funciona perfectamente sin IA, solo omite la categorizaci√≥n autom√°tica.

## üöÄ Uso

### Modo B√°sico (Recomendado)
```bash
python spotify_podcast_extractor.py
```

### Procesar Playlist Espec√≠fica
```bash
python spotify_podcast_extractor.py -p PLAYLIST_ID_AQUI
```

### Modos Especializados

#### Solo Categorizar Episodios Pendientes
```bash
python spotify_podcast_extractor.py --categorize-only
```

#### Realizar una Pregunta sobre los Episodios
```bash
python spotify_podcast_extractor.py -q "¬øQu√© episodios hablan de startups?"
```

#### Solo Exportar Base de Datos Existente
```bash
python spotify_podcast_extractor.py --export-only
```

#### Exportar Playlist Espec√≠fica
```bash
python spotify_podcast_extractor.py --export-only --playlist-id-for-export PLAYLIST_ID
```

#### Desactivar IA
```bash
python spotify_podcast_extractor.py --no-llm
```

#### Resetear Base de Datos
```bash
python spotify_podcast_extractor.py --reset-db
```

#### Archivo de Salida Personalizado
```bash
python spotify_podcast_extractor.py -o mi_archivo_podcasts.xlsx
```

### üîê Primera Ejecuci√≥n (OAuth)

1. El script abrir√° autom√°ticamente tu navegador
2. Inicia sesi√≥n en Spotify y autoriza la aplicaci√≥n
3. Spotify te redirigir√° a `https://example.com/callback?code=...`
4. **La p√°gina mostrar√° "no encontrada" - ¬°es normal!**
5. Copia la URL completa de la barra de direcciones
6. P√©gala en la terminal cuando se solicite
7. Las credenciales se guardan autom√°ticamente para futuros usos

## üìä Datos Extra√≠dos

Para cada episodio de podcast:

| Campo | Descripci√≥n |
|-------|-------------|
| **T√≠tulo** | Nombre del episodio |
| **Descripci√≥n** | Descripci√≥n completa del episodio |
| **Podcast** | Nombre del show/podcast |
| **Duraci√≥n (min)** | Duraci√≥n en minutos |
| **Fecha Agregado** | Cu√°ndo se a√±adi√≥ a la playlist |
| **URL Spotify** | Enlace directo al episodio |
| **Categor√≠a** | Clasificaci√≥n autom√°tica por IA |
| **ID Playlist** | Identificador de la playlist |
| **Fecha Procesado** | Cu√°ndo se extrajo la informaci√≥n |

## ü§ñ Categorizaci√≥n Inteligente

### C√≥mo Funciona
- **Gemini AI** analiza t√≠tulo y descripci√≥n de cada episodio
- Agrupa episodios en categor√≠as coherentes y limitadas
- **Reutiliza categor√≠as existentes** para mantener consistencia
- **Respeta el l√≠mite m√°ximo** de categor√≠as configurado

### Configuraci√≥n de IA
```bash
# Modelo a usar (m√°s potente = m√°s preciso, m√°s caro)
GEMINI_MODEL_NAME=gemini-2.5-flash  # Recomendado: r√°pido y preciso

# Control de cuota (peticiones por minuto)
GEMINI_RPM_LIMIT=10  # Ajusta seg√∫n tu plan

# M√°ximo de categor√≠as totales
MAX_CATEGORIES=8  # Evita fragmentaci√≥n excesiva
```

### Ejemplos de Categor√≠as Generadas
- "Tecnolog√≠a"
- "Desarrollo Personal"
- "Negocios"
- "Historia"
- "Ciencia"

---

## üí¨ Preguntas y Respuestas con IA

Una vez que has procesado tus playlists, puedes usar la IA para "conversar" con tu base de datos de episodios.

### C√≥mo Funciona
- **Contexto Completo**: El script recupera todos los episodios de tu base de datos local.
- **Prompt Inteligente**: Se env√≠a a Gemini tu pregunta junto con los t√≠tulos y descripciones de los episodios como contexto.
- **Respuesta Basada en Datos**: La IA tiene la instrucci√≥n estricta de responder **√∫nicamente** con la informaci√≥n encontrada en tus podcasts, evitando inventar datos. Si no encuentra nada, te lo dir√°.

### Ejemplo de Uso
Si ejecutas:
```bash
python spotify_podcast_extractor.py -q "¬øQu√© episodios hablan del poder del silencio en la comunicaci√≥n?"
```

## üóÉÔ∏è Base de Datos

### Estructura
El script crea autom√°ticamente `spotify_podcasts.db` con:

- **Tabla `podcasts`**: Informaci√≥n de episodios
- **Tabla `playlists`**: Control de sincronizaci√≥n
- **Evita duplicados**: Solo procesa episodios nuevos
- **Persistente**: Los datos se mantienen entre ejecuciones

### Ventajas
- ‚ö° **Ejecuciones r√°pidas**: Solo procesa contenido nuevo
- üí∞ **Ahorra API calls**: Tanto de Spotify como de Gemini
- üìà **Historial completo**: Mantiene registro de todos los episodios procesados

## üîß Argumentos de L√≠nea de Comandos

```bash
# Ayuda completa
python spotify_podcast_extractor.py --help

# Argumentos principales
-p, --playlist PLAYLIST_ID    # Playlist espec√≠fica a procesar
--categorize-only             # Solo categorizar pendientes  
--export-only                 # Solo exportar a Excel
--no-llm                      # Desactivar Gemini AI
--reset-db                    # Eliminar base de datos
-o, --output FILENAME         # Nombre de archivo Excel
--playlist-id-for-export ID   # Exportar solo una playlist
```

## üìÅ Estructura del Proyecto

```
spotify-podcast-extractor/
‚îú‚îÄ‚îÄ spotify_podcast_extractor.py  # Script principal
‚îú‚îÄ‚îÄ requirements.txt               # Dependencias Python  
‚îú‚îÄ‚îÄ .env.example                  # Plantilla de configuraci√≥n
‚îú‚îÄ‚îÄ .env                         # Tu configuraci√≥n (no se sube a Git)
‚îú‚îÄ‚îÄ .gitignore                   # Archivos ignorados por Git
‚îú‚îÄ‚îÄ .spotipyoauthcache           # Cache OAuth (generado autom√°ticamente)
‚îú‚îÄ‚îÄ spotify_podcasts.db          # Base de datos SQLite (generada)
‚îî‚îÄ‚îÄ README.md                    # Esta documentaci√≥n
```

## üìã Archivos Generados

### Archivo Excel
- **Nombre autom√°tico**: `spotify_podcasts_PLAYLIST_ID_YYYYMMDD_HHMMSS.xlsx`
- **Formato profesional**: Columnas auto-ajustadas, fechas formateadas
- **Datos ordenados**: Por fecha de agregado (m√°s reciente primero)

### Base de Datos SQLite
- **Archivo**: `spotify_podcasts.db`
- **Portable**: Puedes copiarlo, respaldarlo o inspeccionarlo con cualquier herramienta SQLite

## üõ†Ô∏è Soluci√≥n de Problemas

### üîë Problemas de Autenticaci√≥n
```bash
# Error: Token expirado
rm .spotipyoauthcache
python spotify_podcast_extractor.py  # Vuelve a autenticar
```

### ü§ñ Problemas con Gemini AI
```bash
# Error: Cuota excedida
python spotify_podcast_extractor.py --no-llm  # Omitir IA

# Error: API key inv√°lida
# Verifica GEMINI_API_KEY en .env
```

### üìä Base de Datos Corrupta
```bash
# Resetear completamente
python spotify_podcast_extractor.py --reset-db
```

### üéµ Playlist Vac√≠a
- Verifica que la playlist contenga **episodios de podcast**, no m√∫sica
- Comprueba que el `PLAYLIST_ID` sea correcto

### üîê Permisos Insuficientes
Aseg√∫rate de que tu app Spotify tenga los scopes:
- `playlist-read-private`
- `playlist-read-collaborative`

## üìä Estad√≠sticas

Al finalizar, el script muestra:
- **Total de episodios** en base de datos
- **Top 5 categor√≠as** m√°s populares
- **Episodios procesados** en esta ejecuci√≥n

## ü§ù Contribuciones

¬°Las contribuciones son bienvenidas!

1. **Fork** el proyecto
2. **Crea** una rama para tu feature: `git checkout -b feature/amazing-feature`
3. **Commit** tus cambios: `git commit -m 'Add amazing feature'`
4. **Push** a la rama: `git push origin feature/amazing-feature`
5. **Abre** un Pull Request

## üìù Licencia

MIT License - ver archivo `LICENSE` para detalles.

## üîí Seguridad y Privacidad

### ‚ö†Ô∏è Importantes Recordatorios
- **Nunca subas** tu archivo `.env` a Git
- **Nunca compartas** tus credenciales de Spotify o Gemini
- **Revisa** el archivo `.gitignore` para protecci√≥n autom√°tica

### üîê Datos Locales
- Toda la informaci√≥n se almacena **localmente** en tu m√°quina
- **No se env√≠a** informaci√≥n a terceros (excepto APIs de Spotify/Gemini)
- **Controlas completamente** tus datos

## üÜò Soporte

### Recursos √ötiles
- [Documentaci√≥n Spotify API](https://developer.spotify.com/documentation/)
- [Gemini AI Pricing](https://ai.google.dev/pricing)
- [Issues en GitHub](https://github.com/tu-usuario/spotify-podcast-extractor/issues)

### Logs y Debugging
El script proporciona logs detallados para facilitar el diagn√≥stico de problemas.

---

**¬°Disfruta organizando tus podcasts de Spotify con inteligencia artificial! üéßü§ñ**